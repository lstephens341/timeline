{% extends 'photoupload/base.html' %}
{% load staticfiles %}

{% block headAndStyle %}
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="/resources/demos/style.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<link rel="stylesheet" href="{% static 'timeline/style.css' %}">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script>
  $( function() {
    $( "#slider-range" ).slider({
      range: true,
      min: 1960,
      max: 2040,
      values: [ 1960, 2020 ],
      slide: function( event, ui ) {
        $( "#amount" ).val( "" + ui.values[ 0 ] + " - " + ui.values[ 1 ] );
      }
    });
    $( "#amount" ).val( "" + $( "#slider-range" ).slider( "values", 0 ) +
      " - " + $( "#slider-range" ).slider( "values", 1 ) );
    $('#slider-range > span').eq(0).attr('style', 'height:2.75em');
    $('#slider-range > span').eq(1).attr('style', 'height:2.75em;left:75%');
  } );
  $(function() {
    $('#slider-range').mouseup(function() {
      // console.log($('#slider-range').slider("values"));
      $('.yearField').each(function(string) {
        string = parseInt($(this).html().replace('<span class="caret" style="transform:rotate(-180deg)"></span>', ''));
        // console.log(string);
        // console.log($('#slider-range').slider('values')[0]);
        if(string >= $('#slider-range').slider('values')[0] && string <= $('#slider-range').slider('values')[1]) {
          $(this).parent().show();
          console.log(string + 'inside range');
        }
        else {
          $(this).parent().hide();
          // console.log($(this).parent().html());
        }
        // console.log($(this).html());
      });
    });
  });

  // $(document).ready(function() {
  //   prev = ''
  //   appendHTML = '</div>'
  //   $('.yearField').each(function(counter) {
  //           if($(this).html() === prev) {
  //             // console.log($(this).html() + ' ' + counter + ' ' + 'same');
  //             $(this).hide();
  //           }
  //           else {
  //             // console.log(prev);
  //             // console.log($(this).html() + ' ' + counter + ' ' + 'new');
  //             counter = 0;
  //             $(this).append(appendHTML);
  //           }
  //           prev = $(this).html();
  //           counter++;
  //           if(counter > 3) {
  //             counter = counter - 3;
  //           }
  //           $(this).next().addClass('col' + counter)
  //   });
  // });
  </script>
<head>
<meta charset="UTF-8">
<!-- <title>Upload Images</title> -->
</head>
{% endblock %}

{% block header %}

{% endblock %}

<!-- <html> -->
{% block content %}
<body>

<!-- <h1>Image Uploader</h1>
<form enctype="multipart/form-data" method="POST" action="">
{% csrf_token %}
{{ form.as_p }}
<input type="submit" value="Upload"/>
</form> -->




<div id='filterTray' style='border-radius:20px;margin-left:10px;margin-right:10px'>
  <div>
    <img id="filterHeader" src="{% static 'timeline/Filter-2-icon.PNG' %}" style='height:35px;width:35px;margin-left:5px'><span class="caret" style="transform:rotate(-180deg)"></span>
  </div>
  <div id='filterContainer' style="height:125px;display:none">
    <div style='float:left;margin-left:15px;width:50%'>
      <p>
        <label for="amount">Years:</label>
        <input type="text" id="amount" readonly style="border:0; color:#f6931f; font-weight:bold;">
      </p>
      <div id="slider-range" style='height:32px'></div>
    </div>
    <div style='float:left;width:45%;margin-left:35px;margin-top:35px'>
      <div>
        <input type='text' id='firstTagSearch' class='form-control' placeholder='Filter by tags' style='width:300px;float:left'>
        <input type='submit' id='filterSubmit' class='btn btn-outline-dark' value='Apply Filters' style=' margin-left:10px;float:right'>
      </div>
    </div>
  </div>
</div>

{% for image in images %}
  {% ifchanged image.yearField %}
    </div></div></div><div class='yearBreak' style='float:left'>
      <div class="panel panel-primary year-container">
            <div class="panel-heading yearField">{{image.yearField}}
              <!-- <div style='border-radius:20px;margin-left:3%;margin-right:3%;margin-bottom:15px;position:sticky;top:0;padding:5px;background-color:#e6f0ff'>
                <h2 class="yearField" style="margin-left:625px">{{ image.yearField }} <span class="caret" style='transform:rotate(-180deg)'></span></h1>
              </div> -->
            </div>
    <div class="panel-body">
      {% endifchanged %}
      <div class="imageContainer{{image.yearField}}" style="float:left;width:25%;margin:auto">
        <a href="{% url 'inspect' forloop.counter %}">
          <img class="timelinePhoto" src='{{ MEDIA_URL }}{{ image.image }}' value='{{image.tags}}' style="width:250px;height:250px;margin-left:35px;margin-bottom:100px">
        </a>
      </div>
      {% if forloop.last %}
  </div>
  {% endif %}
{% endfor %}
<!--


{% for image in images %}
  {% ifchanged image.yearField %}
    </div><div class='yearBreak' style='float:left'>
    <div style='border-radius:20px;margin-left:3%;margin-right:3%;margin-bottom:15px;position:sticky;top:0;padding:5px;background-color:#e6f0ff'>
      <h2 class="yearField" style="margin-left:625px">{{ image.yearField }} <span class="caret" style='transform:rotate(-180deg)'></span></h1>
    </div>
  {% endifchanged %}
  <div class="imageContainer{{image.yearField}}" style="float:left;width:25%;margin:auto">
    <a href="{% url 'inspect' forloop.counter %}">
      <img class="timelinePhoto" src='{{ MEDIA_URL }}{{ image.image }}' value='{{image.tags}}' style="width:250px;height:250px;margin-left:60px;margin-bottom:100px">
    </a>
  </div>
  {% if forloop.last %}
  </div>
  {% endif %}
{% endfor %} -->

</body>
<script>

$(function() {
  $('.yearField').click(function() {
          string = $(this).html().replace('<span class="caret" style="transform:rotate(-180deg)"></span>', '');
          year = ".imageContainer" + string;
          $(year).toggle();
  });
});
$(function() {
  $('#filterHeader').click(function() {
      $('#filterContainer').toggle();
      $('#filterTray').style('border: solid black')
  });
});
$(function () {
  $('#filterSubmit').on('click', function(inputString) {
    inputString = $('#firstTagSearch').val();
    $('.timelinePhoto').each(function(photoString) {
      photoString = $(this).attr('value');
      // console.log(photoString);
      if(photoString.indexOf(inputString) == -1) {
        $(this).parent().parent().hide();
      }
      else {
        $(this).parent().parent().show();
      }
    });
  });
});


 'undefined'=== typeof _trfq || (window._trfq = []);'undefined'=== typeof _trfd && (window._trfd=[]),_trfd.push({'tccl.baseHost':'secureserver.net'}),_trfd.push({'ap':'cpsh'},{'server':'p3plcpnl0769'}) // Monitoring performance to make your website faster. If you want to opt-out, please contact web hosting support.</script><script src='https://img1.wsimg.com/tcc/tcc_l.combined.1.0.6.min.js'></script></html>

{% endblock %}
